# ============================================================================
# Quackback Environment Configuration
# ============================================================================
# Copy this file to .env and fill in your values.
# For self-hosted deployments, only the "Required" section needs configuration.

# ============================================================================
# Required
# ============================================================================

# PostgreSQL connection string
DATABASE_URL="postgresql://postgres:password@localhost:5432/quackback"

# Public URL for your Quackback instance (used for auth, emails, OAuth callbacks)
BASE_URL="http://localhost:3000"

# Secret key for authentication and encryption - MUST be at least 32 characters
# This single key is used for session signing and deriving encryption keys.
# Generate with: openssl rand -base64 32
SECRET_KEY=""

# Redis/Dragonfly connection for background job queue (BullMQ)
# Dragonfly is included in docker-compose and started by `bun run setup`.
REDIS_URL="redis://localhost:6379"

# ============================================================================
# Email (optional)
# ============================================================================
# If not configured, emails are logged to console (useful for development).
# Priority: SMTP (if configured) → Resend (if configured) → Console logging
#
# Option 1: SMTP (recommended for self-hosted, works with any provider)
#   - Gmail: smtp.gmail.com (port 587, use app password)
#   - Amazon SES: email-smtp.{region}.amazonaws.com
#   - Mailgun: smtp.mailgun.org
#   - SendGrid: smtp.sendgrid.net

EMAIL_SMTP_HOST=""
EMAIL_SMTP_PORT="587"
EMAIL_SMTP_USER=""
EMAIL_SMTP_PASS=""
# EMAIL_SMTP_SECURE="true"  # Uncomment for port 465 (implicit TLS)

# Option 2: Resend API (simpler setup, requires Resend account)
# Get your API key at: https://resend.com/api-keys

EMAIL_RESEND_API_KEY=""

# Sender address (REQUIRED when using SMTP or Resend)
# Format: "Your App <noreply@yourdomain.com>"
EMAIL_FROM=""

# ============================================================================
# AI (optional)
# ============================================================================
# Enable AI features like auto-categorization and summarization.

# OpenAI API
OPENAI_API_KEY=""
OPENAI_BASE_URL=""  # Optional: custom endpoint (e.g., Azure OpenAI, Cloudflare AI Gateway)

# ============================================================================
# File Storage (for image uploads)
# ============================================================================
# S3-compatible storage for image uploads in changelogs.
# Supports AWS S3, Cloudflare R2, Backblaze B2, MinIO, Railway Buckets, and other S3-compatible services.
# If not configured, image upload will be disabled in the rich text editor.
#
# S3_PUBLIC_URL is optional. If not set, files are served via BASE_URL/api/storage
# using presigned URL redirects (works with any provider, including private buckets).
# Set it explicitly to use a CDN or public bucket URL instead.
#
# For local development, MinIO is included in docker-compose and configured by default.
# Run `bun run setup` or `docker compose up -d minio` to start it.

# MinIO (local development - enabled by default)
S3_ENDPOINT="http://localhost:9000"
S3_BUCKET="quackback"
S3_REGION="us-east-1"
S3_ACCESS_KEY_ID="minioadmin"
S3_SECRET_ACCESS_KEY="minioadmin"
S3_FORCE_PATH_STYLE="true"
S3_PUBLIC_URL=""

# ============================================================================
# Disable Telemetry (optional)
# ============================================================================
# Anonymous usage statistics are enabled by default to help improve Quackback.
# Uncomment to disable, or use the toggle in Admin > Settings > Telemetry.

# TELEMETRY_ENABLED="false"
# DO_NOT_TRACK="1"                  # Standard opt-out (https://consoledonottrack.com)

# For production, replace with your preferred S3-compatible provider:
#
# AWS S3 (public bucket):
#   S3_ENDPOINT=""  # Leave empty for AWS S3
#   S3_BUCKET="your-bucket-name"
#   S3_REGION="us-east-1"
#   S3_ACCESS_KEY_ID="your-access-key"
#   S3_SECRET_ACCESS_KEY="your-secret-key"
#   S3_FORCE_PATH_STYLE="false"
#   S3_PUBLIC_URL="https://your-bucket-name.s3.us-east-1.amazonaws.com"
#
# AWS S3 (private bucket via presigned redirect):
#   S3_ENDPOINT=""
#   S3_BUCKET="your-bucket-name"
#   S3_REGION="us-east-1"
#   S3_ACCESS_KEY_ID="your-access-key"
#   S3_SECRET_ACCESS_KEY="your-secret-key"
#   S3_FORCE_PATH_STYLE="false"
#   S3_PUBLIC_URL="https://your-app.example.com/api/storage"
#
# Cloudflare R2:
#   S3_ENDPOINT="https://<account-id>.r2.cloudflarestorage.com"
#   S3_BUCKET="your-bucket-name"
#   S3_REGION="auto"
#   S3_ACCESS_KEY_ID="your-access-key"
#   S3_SECRET_ACCESS_KEY="your-secret-key"
#   S3_FORCE_PATH_STYLE="true"
#   S3_PUBLIC_URL="https://your-custom-domain.com"
#
# Railway Buckets (private-only — served via BASE_URL/api/storage automatically):
#   S3_ENDPOINT=""  # Leave empty to use the presigned redirect
#   S3_BUCKET="your-bucket-name"
#   S3_REGION="us-east-1"
#   S3_ACCESS_KEY_ID="your-access-key"
#   S3_SECRET_ACCESS_KEY="your-secret-key"
#   S3_FORCE_PATH_STYLE="true"
